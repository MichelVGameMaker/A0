/* =========================================================
   0) Variables & fondations
   ========================================================= */
:root{
  /* --- Couleurs --- */
  --emphase:       #02ccba;
  --emphase_white: #faedf6;
  --red:           #8b0000;
  --green:         #06402b;
  --white:         #ffffff;
  --pink:          #faebf2;
  --almost_white:  #f8f8f8; 
  --light_grey:    #e8e8e8;
  --grey:          #d4d4d4;
  --dark_grey:     #ccc;
  --darker_grey:   #bbb;
  --black:         #000000;  
  --alert:         #f5a623;
  /* --- Styles --- */
  --bodyBack:      #8b0000;
  --contentBack:   var(--emphase_white);
  --panelBack:     var(--white);
  --panelBord:     var(--almost_white);

  --emptyColor:    var(--dark_grey);
  --labelColor:    var(--darker_grey);
  --filledColor:   var(--black);
  --selectedColor: var(--black);
  --selectedBack:  var(--grey);
  --selectedBord:  var(--emphase);
  --focusedBack:   var(--grey);
  --focusedColor:  var(--white);
  --focusedBord:   var(--emphase);
  --clickableBack: var(--light_grey);
  --clickableBord: var(--almost_white); 
  --nonClickableBord: var(--emphase);
  /* --- RPE styles --- */
  --rpe-ink:       #0f243a;
  --rpe-5-bg:      #e6f1ff;
  --rpe-5-bord:    #c9ddf6;
  --rpe-6-bg:      #ede8ff;
  --rpe-6-bord:    #d6ccff;
  --rpe-7-bg:      #ffe9d6;
  --rpe-7-bord:    #f6d7bd;
  --rpe-8-bg:      #ffe2e5;
  --rpe-8-bord:    #f3c7cf;
  --rpe-9-bg:      #f3d9e2;
  --rpe-9-bord:    #e7c1cd;
  --rpe-10-bg:     #f0f0f0;
  --rpe-10-bord:   #d7d7d7;


  /* --- Mesures unifiées --- */
  --control-h: 44px;       /* hauteur unique pour TOUT (inputs, selects, tags, boutons, etc.) */
  --radius:    12px;       /* border-radius unique */
  --pad-x:     12px;       /* padding horizontal par défaut */
  --pad-y:     10px;       /* padding vertical par défaut */
  --pad-tight: 4px;        /* padding pour les éléments denses */
  --gap:       6px;        /* marge/gap par défaut entre éléments */
  --set-synopsis-width: calc(9ch + 4px); /* largeur fixe des tags de série (888x 888kg) */
  --set-synopsis-gap: 3px; /* espacement horizontal entre tags de série */

  /* --- Typo unifiée --- */
  --font:      system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  --fs-big:    19px;        /* icones */
  --fs-base:   16px;        /* base */
  --fs-small:  13px;        /* petits textes (ex: cellules série) */
  --fs-rpe:    13px;        /* taille spécifique RPE dans série */
  --fw-light:  500;
  --fw-base:   600;
  --fw-strong: 700;

/* Hauteurs “réelles” en tenant compte des bordures */
  --header-h:  44px;       /* hauteur du header */
  --tab-h:     44px;       /* hauteur de la tab bar */
  --tabbar-h: calc(var(--tab-h) + 2px);      /* 2px = border-top de .tabbar */
  --header-total-h: calc(var(--header-h) + 2px); /* 2px = border-bottom du header/subheader */
}


/* Safe areas iOS */
.safe-top    { padding-top: env(safe-area-inset-top, 0); }
.safe-bottom { padding-bottom: calc(env(safe-area-inset-bottom, 0) + 8px); }


/* =========================================================
   1) Contenu
   ========================================================= */
 /* Reset simple */
*{
  box-sizing:border-box;
  user-select:none;
  -webkit-user-select: none;
  -webkit-tap-highlight-color: transparent;
}
html {
   height:100%;
   font-size: var(--fs-base);
   -webkit-text-size-adjust: 100%;
   overscroll-behavior: none;
}
body{
    height:100%;
    margin:0;
    background: var(--bodyBack);          /* 4.Fond app */
    color: var(--black);
    font-family: var(--font);
    font-size: var(--fs-base);
    font-weight: var(--fw-base);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    overscroll-behavior: none;
}

.app-splash {
    position: fixed;
    inset: 0;
    z-index: 9999;
    display: grid;
    place-items: center;
    background: var(--emphase);
    color: var(--white);
    font-size: clamp(36px, 10vw, 72px);
    font-weight: var(--fw-strong);
    letter-spacing: 0.08em;
    transition: opacity 180ms ease, visibility 180ms ease;
}

.app-splash.is-hidden {
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
}

/* Ecran */
.screen {
    display: flex;
    flex-direction: column;
}
.screen[hidden] { display: none !important; }

/* Grilles utilitaires */
.row{ display:flex; align-items:center; gap:var(--gap); }
.row.between{ justify-content:space-between; }
.row #routineName{ flex:1 1 auto; min-width:0; }
.row #routineIcon{ flex:0 0 auto; width:auto; min-width:72px; }
.full{ width:100%; }
.flex-1{ flex:1; }
  
.content {
    flex: 1;
    background: var(--contentBack);                /* panneau blanc */
    border-inline: 6px solid var(--panelBord);
    padding:  8px;
    padding-top: var(--header-total-h);
    padding-bottom: calc(var(--tabbar-h) + env(safe-area-inset-bottom, 0) + 8px);
    min-height: calc(100svh - var(--tabbar-h) - var(--header-total-h) - env(safe-area-inset-bottom, 0));  overflow-y: auto;
}


/* =========================================================
   2) Tab bar (bas)
   ========================================================= */
.tabbar{
    z-index:10;
    position: fixed; bottom:0; left:0; right:0; 
    height: var(--tab-h);
    display:flex; align-items:center; justify-content:space-between;
    background: var(--panelBack);
    border-top: 2px solid var(--panelBord);
}
.tab{
    flex: 1 1 25%;
    height: 100%;
    box-sizing: border-box;
    font-size: 32px;
    padding: 0 var(--pad-x);
    background: transparent;
    border:3px solid transparent;
    cursor:pointer;
}
.tab.active{
    border-top: 3px solid var(--focusedBord);         /* 4.Onglet actif bordure haute noir */
}

/* =========================================================
   3) Header principal (haut)
   ========================================================= */
header{
    z-index:5;
    position: fixed; top: 0; left:0; right:0;
    height: var(--header-h);
    display:grid;
    --header-side-w: 60px;
    grid-template-columns: var(--header-side-w) minmax(0, 1fr) var(--header-side-w);
    align-items:center;
    padding: 0 var(--pad-x);
    background: var(--panelBack);
    border-bottom: 2px solid var(--panelBord);
}

.header-left,
.header-right{
    display:flex;
    align-items:center;
    gap: var(--gap);
    width: 100%;
}
.header-left{
    justify-content: flex-start;
}
.header-right{
    justify-content: flex-end;
}
.header-center{
    display:flex;
    justify-content:center;
    flex-direction: column;
    align-items: center;
    min-width: 0;
}
header .title{
    flex:1;
    font-weight: var(--fw-strong);
    text-align:center;
    overflow:hidden;
    text-overflow:ellipsis;
    white-space:nowrap;
    max-width: min(260px, calc(100vw - (var(--header-side-w) * 2) - (var(--pad-x) * 2)));
    width: 100%;
}
header .subtitle{
    font-size: 0.78em;
    color: var(--muted);
    margin-top: 2px;
    text-align: center;
}
header #exReadTitle{
    white-space: normal;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
}
header .header-left .btn{
    width: 100%;
    justify-content: flex-start;
    background: transparent;
    border-color: transparent;
    text-align: left;
}

/* =========================================================
   4) Modale
   ========================================================= */
.modal{
    border:none;
    border-radius: var(--radius);
    padding:var(--gap);
    max-width:520px;
    width:92vw;
    position:fixed;
    top: env(safe-area-inset-top, 0);
    left:50%;
    transform: translateX(-50%);
}

.modal-header{
    height: var(--header-h);
    display:flex;  align-items:center; justify-content:space-between;
    padding: var(--pad-y) var(--pad-x);
    background: var(--panelBack);
    border-bottom:2px solid var(--panelBord);
}
.modal-fixed .modal-header{
    flex: 0 0 auto;
    position: relative;
    justify-content:center;
}
.modal-title{
    flex: 1 1 auto;
    text-align:center;
}
.modal-close{
    position:absolute;
    right: var(--pad-x);
    top: 50%;
    transform: translateY(-50%);
}
.modal-fixed{
    height: 80vh;
    top: 50%;
    padding: 0;
    transform: translate(-50%, -50%);
}
.modal-centered{
    height: auto;
    max-height: 80vh;
    margin: 0;
    top: 50%;
    transform: translate(-50%, -50%);
}
.modal::backdrop{ 
    background: rgba(0,0,0,.25); 
    }

.modal-fixed .modal-form{
    display:flex;
    flex-direction:column;
    height: 100%;
}

.modal-body{
    flex: 1 1 auto;
    overflow: auto;
    padding: var(--gap);
}
.modal-footer{
    flex: 0 0 auto;
    padding: var(--pad-y) var(--pad-x);
    border-top: 1px solid var(--panelBord);
    background: var(--panelBack);
}
.modal-actions{
    display:flex;
    align-items:center;
    gap:var(--gap);
}
.modal-actions .btn{
    flex:1 1 0;
}
.confirm-dialog{
    --confirm-bord: transparent;
    --confirm-accent: var(--confirm-bord);
    border: 2px solid var(--confirm-bord);
}
.confirm-dialog--danger{
}
.confirm-dialog--error{
    --confirm-bord: var(--red);
}
.confirm-status{
    font-weight: var(--fw-strong);
    color: var(--confirm-accent);
    margin: 0 0 var(--gap);
    text-transform: uppercase;
    letter-spacing: 0.02em;
}
/* =========================================================
   5) Timer
   ========================================================= */
/* Timer bas */
.exec-timer{
    z-index:20;
    position:fixed;
    left:0;
    right:0;
    bottom: calc(var(--tabbar-h) + env(safe-area-inset-bottom, 0));
    display:grid; grid-template-columns: minmax(0, 1fr) auto minmax(0, 1fr);
    align-items:center; gap:12px;
    padding:11px 12px;
    background: var(--panelBack);
    border-top:1px solid var(--panelBord);
}
.tmr-center{ display:flex; align-items:center; justify-content:center; gap:12px; }
.tmr-display{ font-weight: var(--fw-strong); min-width:76px; text-align:center; }
.exec-timer-spacer{
    height: calc(var(--control-h) + 22px);
    background: transparent;
}

/* =========================================================
   6) Textes  & Images
   ========================================================= */
/* Textes */
.lbl{     color: var(--labelColor); font-weight: var(--fw-strong); }
.element{ font-weight: var(--fw-strong); }
.details{ color: var(--labelColor); font-weight: var(--fw-light); }
.exec-date-row{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap: 12px;
}
.exec-date-tag{
    flex: 0 0 auto;
    max-width: none;
}
.centered{ text-align:center; }
.listing{ margin: 0; font-weight: var(--fw-strong); padding-left: 0; list-style-position: inside; }
.listing-instructions{ font-weight: var(--fw-base); }

/* Grosse image pour l'exécution */
image_big{
     /* Dimension */
    height:auto;
    width:80%;
    object-fit:cover;
    border-radius:var(--radius);
    /* Pas cliquable */
    border:1px solid var(--panelBord);
    touch-action: manipulation;       /* coupe le geste double-tap=zoom */
    /* Pas de drag n drop*/
    -webkit-user-drag: none;
    user-drag: none;
}
/* =========================================================
   7) Contrôles unifiés (inputs, selects, tags, listes)
   ========================================================= */
/* États invisibles */
.sr-only{ position:absolute; left:-9999px; }

.is-clickable {
    /* Cliquable */
    border: 1px solid var(--clickableBord);
    background: var(--clickableBack); 
    cursor: pointer;
    touch-action: manipulation;       /* coupe le geste double-tap=zoom */
}
.is-focused {
    /* Focusé */
    background: var(--focusedBack);
    font-weight: var(--fw-strong);
    outline: 2px solid var(--focusedBord);
    outline-offset: 2px;
}
.has-value{
   /* Texte rempli */
   color: var(--filledColor);
   font-weight: var(--fw-strong);
}
.is-default{
    /* Texte vide */
    color: var(--emptyColor);
    font-weight: var(--fw-light);
}

/* Base champs & listes */
.input, select, textarea{
    /* Dimension pour tous les éléments */
    height: var(--control-h);
    width: 100%;
    padding: 0 var(--pad-x);
    border-radius: var(--radius);
    /* Cliquable */
    border: 1px solid var(--clickableBord);
    background: var(--clickableBack); 
    cursor: pointer;
    touch-action: manipulation;       /* coupe le geste double-tap=zoom */
    user-select: text;
    -webkit-user-select: text;
    /* Texte rempli */
    color: var(--filledColor);
    font-weight: var(--fw-strong);
    font-size: var(--fs-base);
}
textarea{
    resize: vertical;
}
/* Tags */
.tags{
  --tag-gap: 1px;                              /* UN seul pixel d’écart */
  --tag-columns: 1;
  --tag-width: calc((100% - (var(--tag-columns, 1) - 1) * var(--tag-gap, 1px)) / var(--tag-columns, 1));
  display:flex; flex-wrap:wrap;
  gap: var(--tag-gap);
}
.tags.mono .tag{
  font-family: "SFMono-Regular","Roboto Mono","Menlo","Courier New",monospace;
  font-weight: var(--fw-base);
}
.tag{
    /* Dimension pour tous les éléments */
    height: var(--control-h);
    max-width: var(--tag-width);
    min-width:0;
    padding: 0 var(--pad-x);
    border-radius: var(--radius);
    /* Cliquable */
    border: 1px solid var(--clickableBord);
    background: var(--clickableBack); 
    cursor: pointer;
    touch-action: manipulation;       /* coupe le geste double-tap=zoom */
  font: inherit;
  display:inline-flex; align-items:center; justify-content:center;
  flex: 0 0 var(--tag-width);
  margin: 0;
  box-sizing:border-box;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
  text-align:center;
}
/* Focus/actif -> fond gris + bordure strong */
.input:focus,
select:focus,
textarea:focus{
    /* Focusé */
    background: var(--focusedBack);
    font-weight: var(--fw-strong);
    outline: 2px solid var(--focusedBord);
    outline-offset: 2px;
}
.tag:focus{
    /* Focusé */
    background: var(--focusedBack);
    font-weight: var(--fw-strong);
    outline: 2px solid var(--focusedBord);
    outline-offset: 2px;
}

.tag.selected{
    background: var(--selectedBack);
    border-color: var(--selectedBord);
}

/* =========================================================
   7 bis) Planning (sous-onglets)
   ========================================================= */
.planning-tabs{
    --tag-columns: 3;
    position: sticky;
    top: 0;
    z-index: 2;
    background: var(--contentBack);
    padding: 8px 0;
    border-bottom: 1px solid var(--panelBord);
}

/* =========================================================
   7 ter) Fiche exercice (onglets)
   ========================================================= */
.exercise-read-tabs{
    --tag-columns: 3;
    position: sticky;
    top: 0;
    z-index: 2;
    background: var(--contentBack);
    padding: 8px 0;
    border-bottom: 1px solid var(--panelBord);
}
.exercise-read-panel{
    display:flex;
    flex-direction:column;
    gap:12px;
}
.exercise-read-tab{
    padding-top: 12px;
}
.exercise-history-list{
    display:flex;
    flex-direction:column;
    gap:12px;
}
.exercise-history-session{
    display:flex;
    flex-direction:column;
    gap:6px;
    padding:10px 12px;
    border:1px solid var(--panelBord);
    border-radius: var(--radius);
    background: var(--panelBack);
}

/* =========================================================
   8) Boutons
   ========================================================= */
.btn{
    /* Dimension pour tous les éléments */
    min-height:var(--control-h);
    min-width:var(--control-h);
    padding: 0 var(--pad-x);
    border-radius: var(--radius);  
    /* Cliquable */
    border: 1px solid var(--clickableBord);
    background: var(--clickableBack); 
    cursor: pointer;
    touch-action: manipulation;       /* coupe le geste double-tap=zoom */
     
  display:inline-flex; align-items:center; justify-content:center;   
  color: var(--black);
  font-weight: var(--fw-strong);
}
.btn:active{ transform: scale(.9); }
/* En-tête RETOUR */
.btn.ghost{
    border-color: var(--black);
}

/* CTA */
.btn.primary{
   border-radius: 50%;
   font-size: var(--fs-big);
   background: transparent;
   border-color: var(--emphase);
   color: var(--emphase);
}

.btn.cta{
  background: var(--emphase);
  border-color: var(--emphase);
  color: var(--white);
}

/* Supprimer */
.btn.danger{
  border-color: var(--red);
  color: var(--red);
}

/* Image cliquable (ex: preview) */
.btn.image{
  border-color: var(--black);
}

.btn-icon{
  min-width:36px;
  padding:8px;
  font-size:18px;
  line-height:1;
}

/* Stepper vertical */
.vstepper{
        display:flex;
        flex-direction:column;
        gap:4px;
        touch-action: manipulation;       /* coupe le geste double-tap=zoom */
}
.vstepper .btn{ min-height:32px; line-height:1; }

/* Disabled */
.btn[disabled]{ opacity:.5; cursor:not-allowed; }


/* =========================================================
   8) Boutons
   ========================================================= */
/* Panneaux/cartes (listes, cartes) */

.exercise-card,
.list-card{
  background: var(--white);
  border: 1px solid var(--black);
  border-radius: var(--radius);
  padding: var(--pad-y) var(--pad-x);
}
.exercise-card-row,
.list-card__row{ display:flex; align-items:stretch; gap:var(--gap); min-height:68px; }
.exercise-card-left,
.list-card__start{
  display:grid;
  grid-template-columns: auto 1fr;
  align-items:center;
  gap:10px;
  flex:1 1 auto;
  min-width:0;
}
.exercise-card-right,
.list-card__end{ display:flex; align-items:center; justify-content:flex-end; gap:8px; flex-shrink:0; min-width:40px; }
.exercise-card-text,
.list-card__body{ display:flex; flex-direction:column; gap:2px; min-width:0; justify-content:center; width:100%; }
.exercise-card-text .element,
.list-card__body .element,
.exercise-card-text .details,
.list-card__body .details{
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}
.exercise-card-text .exercise-card-name{
  display:-webkit-box;
  -webkit-box-orient:vertical;
  -webkit-line-clamp:2;
  white-space:normal;
}
.list-card__handle{
  border:none;
  background:none;
  color:inherit;
  padding:4px;
  border-radius:8px;
  cursor:grab;
  touch-action: none;
  display:flex;
  align-items:center;
  justify-content:center;
}
.list-card__handle:focus-visible{
  outline:2px solid var(--black);
  outline-offset:2px;
}
.list-card__handle:active{
  cursor:grabbing;
}
.list-card__grip{
  display:flex;
  flex-direction:column;
  gap:2px;
  align-items:center;
  justify-content:center;
}
.list-card__grip-dot{
  width:4px;
  height:4px;
  border-radius:50%;
  background:currentColor;
  opacity:.7;
}
.session-card-sets{
  display:flex;
  flex-direction:column;
  gap:4px;
  margin-top:4px;
  width:100%;
}
.session-card-sets-row{
  display:flex;
  flex-wrap:wrap;
  gap:var(--set-synopsis-gap);
  justify-content:flex-start;
  width:100%;
}
.session-card-sets:empty{
  display:none;
}
.session-card-set{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:3px;
  padding:3px 4px;
  border-radius:8px;
  border:1px solid var(--panelBord);
  font-size:var(--fs-small);
  line-height:1.1;
  width:var(--set-synopsis-width);
  max-width:var(--set-synopsis-width);
  flex:1 1 var(--set-synopsis-width);
  text-align:center;
  min-width:0;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}
.session-card-set--empty{
  width:100%;
  max-width:100%;
  justify-content:flex-start;
  text-align:left;
  flex:1 1 100%;
}
.session-card-set--ellipsis{
  justify-content:center;
  font-weight:600;
}
.session-card-set sup{
  font-size:.7em;
  color: inherit;
  font-weight:var(--fw-strong);
  padding: 0 6px;
  border-radius: 999px;
  background: rgba(0, 0, 0, 0.04);
  border: 1px solid var(--rpe-border, transparent);
}

.session-card-set-rpe{
  color: inherit;
}

.rpe-chip{
  display:inline-block;
  padding:4px 8px;
  border-radius:999px;
  font-weight: var(--fw-strong);
  font-size:.9em;
  color: var(--rpe-ink);
  background: var(--panelBack);
  border:1px solid var(--panelBord);
}

.rpe{
  --rpe-bg: var(--panelBack);
  --rpe-border: var(--panelBord);
  color: var(--rpe-ink);
}

.rpe-chip[data-rpe],
.session-card-set[data-rpe],
.set-edit-input[data-rpe],
.set-edit-button[data-rpe],
.inline-keyboard-key[data-rpe]{
  background: var(--rpe-bg, var(--panelBack));
  border-color: var(--rpe-border, var(--panelBord));
  color: var(--rpe-ink);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.45);
}

[data-rpe="5"],
[data-rpe="5.5"]{
  --rpe-bg: var(--rpe-5-bg);
  --rpe-border: var(--rpe-5-bord);
}
[data-rpe="6"],
[data-rpe="6.5"]{
  --rpe-bg: var(--rpe-6-bg);
  --rpe-border: var(--rpe-6-bord);
}
[data-rpe="7"],
[data-rpe="7.5"]{
  --rpe-bg: var(--rpe-7-bg);
  --rpe-border: var(--rpe-7-bord);
}
[data-rpe="8"],
[data-rpe="8.5"]{
  --rpe-bg: var(--rpe-8-bg);
  --rpe-border: var(--rpe-8-bord);
}
[data-rpe="9"],
[data-rpe="9.5"]{
  --rpe-bg: var(--rpe-9-bg);
  --rpe-border: var(--rpe-9-bord);
}
[data-rpe="10"]{
  --rpe-bg: var(--rpe-10-bg);
  --rpe-border: var(--rpe-10-bord);
}

.list-card__icon{
  font-size:14px;
  line-height:1;
}
.session-card-dragging{
  box-shadow:0 10px 24px rgba(0,0,0,.18);
}
.session-card-placeholder{
  border:1px dashed var(--panelBord);
  border-radius:var(--radius);
}
.exercise-card-thumb{
  height:64px;
  width:64px;
  align-self:center;

  object-fit:cover;
  flex-shrink:0;
  border: 1px solid var(--panelBord);
  align-self:stretch;
}

.selected {  
    background: var(--selectedBack);
    color: var(--selectedColor);
}
.exercise-card.clickable{ cursor:pointer; border: var(--black);}

.exercise-card-thumb.clickable{
  cursor: pointer;
  border-color: var(--clickableBord);
}
/* Check Box */
.app-check{
  width: 20px;
  height:20px;
  border-radius:4px;
  appearance:none;
  -webkit-appearance:none;
  display:grid;
  place-content:center;
  font:inherit;  
  /* Cliquable */
  border:1px solid var(--clickableBord);
  background: var(--clickableBack);
  cursor:pointer;
  touch-action: manipulation;       /* coupe le geste double-tap=zoom */
}
.app-check::after{
  content:"✓";
  color:var(--white);
  font-size:14px;
  line-height:1;
  font-weight:var(--fw-strong);;
  transform:scale(0);
  transition:transform 0.15s ease-out;
}
.app-check:checked{
  background:var(--emphase);
}
.app-check:checked::after{
  transform:scale(1);
}
.app-check:focus-visible{
  outline:2px solid var(--emphase);
  outline-offset:2px;
}
/* Eye icon */
.exercise-card-eye{
  border:none;
  background:none;
  color:inherit;
  font-size:14px;
  line-height:1;
  cursor:pointer;
  padding:4px;
  border-radius:50%;
}
.exercise-card-eye:focus-visible{
  outline:2px solid var(--black);
  outline-offset:2px;
}
.exercise-thumb-placeholder{ object-fit:contain; }
.exercise-selection-bar{
  position:sticky;
  top:0;
  z-index:10;
  padding:8px 0;
  background:var(--panelBack);
}
.exercise-selection-bar.hidden{ display:none; }
.exercise-list-section{
  margin:16px 0 8px;
  font-weight:var(--fw-strong);
  color:var(--selectedBord);
  font-size:0.9em;
}
.exercise-list-section:first-child{
  margin-top:0;
}
.exercise-hero-placeholder{ object-fit:contain; }


/* =========================================================
   6) Listes / Filtres (écran Bibliothèque)
   ========================================================= */
.bloque{    display:flex; flex-direction:column; gap:var(--gap); margin-top:var(--gap); }
.panel{
  border: 1px solid var(--panelBord);
  border-radius: var(--radius);
  padding: var(--pad-y) var(--pad-x);
}
.sticky-actions{
  position: sticky;
  bottom: calc(var(--tabbar-h) + env(safe-area-inset-bottom, 0));
  background: var(--panelBord);
  padding-top: var(--gap);
  margin-top: var(--gap);
  z-index: 5;
}

/* =========================================================
   7) Calendriers
   ========================================================= */
   
/* ========= Selecteur Semaine - Contenant ========= */
    .week-strip-wrapper{
      display:flex; 
      align-items:center; 
      gap:var(--gap);
      margin-bottom:12px;
    }
    .week-strip{
      display:flex;
      flex:      1;
	   gap:var(--gap); 
      overflow-x:auto;
      padding-bottom:8px; 
      margin-bottom:0;
      border-bottom:1px dashed var(--panelBord);
      -webkit-overflow-scrolling:touch;
      touch-action:pan-x;
      scroll-snap-type:x mandatory;
      scrollbar-width:none;
    }
    .week-strip::-webkit-scrollbar{ display:none; }
    
    .week-strip .week-page{
      display:grid; grid-template-columns:repeat(7,minmax(0,1fr));
      gap:var(--gap);
      flex:0 0 100%; width:100%;
      scroll-snap-align:start;
      scroll-snap-stop:always;
    }   
    
/* ========= Selecteur Mois - Contenant ========= */
    .month-grid{ 
		display:grid; grid-template-columns: repeat(7,1fr); 
		gap:var(--gap); 
	}

/* ========= Celulles - Contenu ========= */
    .week-strip .day span{ display:block; }
    .week-strip .day-weekday{ font-size: var(--fs-small); text-transform:capitalize; }
    /* Day cell use Tag style */
    .day-cell{
        /* Dimension pour tous les éléments */
        height: var(--control-h);  
        padding: var(--pad-tight);
        border-radius: var(--radius);
        /* Cliquable */
        border: 1px solid var(--clickableBord);
        background: var(--clickableBack); 
        cursor: pointer;
        touch-action: manipulation;       /* coupe le geste double-tap=zoom */    
        /* Contenu */
        text-align:center;
    }
    .day-cell.placeholder{
        background: transparent;
        border-color: transparent;
        cursor: default;
        pointer-events: none;
    }
    
/* ========= Etats ========= */
    .day-cell.planned{
        background:   var(--selectedBack);
        color:        var(--selectedColor);
        border-color: var(--selectedBord);
    }
    .day-cell.has-session{
        background:   var(--selectedBack);
        color:        var(--selectedColor);
        border-color: var(--selectedBord);
    }
    .day-cell.selected{
        /* Focusé */
        background:   var(--focusedBack);
        font-weight:  var(--fw-strong);
        outline: 2px solid var(--selectedBord);
        outline-offset: 2px;
    }

/* =========================================================
   8) Liste de série (séance & routine)
   ========================================================= */
.session-list{
    display:flex;
    flex-direction:column;
    gap:12px;
    margin:16px 0; 
}


/* Grille des séries (3 par ligne) */
.set-grid{
    display:grid; grid-template-columns: repeat(3,1fr);
    gap: var(--gap); margin-top: var(--gap);
}

/* État “vide” */
.empty{
  color: var(--selectedBord);
  border:1px dashed var(--panelBord);
  border-radius: var(--radius);
  padding: 12px; text-align:center;
}

/* =========================================================
   9) Édition exécution (Colonne A) & Timer
   ========================================================= */
.exec-grid{
  display:grid; gap:4px; margin-top:8px;
  grid-template-columns: 1.2fr 1.2fr .8fr .8fr .8fr; /* Reps | Poids | RPE | Repos mn | Repos sec */
  text-align:center; align-items:center;
}
.exec-grid.routine-set-grid{
  grid-template-columns: minmax(32px, 0.4fr) 1fr 1fr .8fr .8fr .8fr; /* # | Reps | Poids | RPE | Repos mn | Repos sec */
}
.routine-set-grid > *{ min-width:0; }
.exec-head{ font-weight: var(--fw-strong); }
.exec-head > *{ display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center; }
.routine-set-head{
  font-size: var(--fs-small);
  color: var(--selectedBord);
}
.routine-set-head .set-editor-label{
  font-weight: var(--fw-strong);
}
.exec-row .input{
  height: var(--control-h); width:100%;
  text-align:center; margin:0; padding:0 8px;
}


.routine-set-row-active{
  box-shadow: inset 0 -2px var(--emphase);
}

.routine-set-order{
  font-weight: var(--fw-strong);
}

.set-edit-button{
  width:100%;
  min-height: var(--control-h);
  font-weight: var(--fw-strong);
  color: var(--black);
  background: var(--panelBord);
  border-color: var(--black);
}
.set-edit-input{
  width:100%;
  min-height: var(--control-h);
  text-align:center;
  font-weight: var(--fw-strong);
  color: var(--black);
  background: var(--panelBord);
  border-color: var(--black);
}
.routine-set-grid .set-edit-button{
  color: var(--black);
}
.routine-set-grid .set-edit-input{
  color: var(--black);
}

.exec-set-row{
  color: var(--black);
}

.exec-set-row .set-edit-button{
  color: inherit;
}
.exec-set-row .set-edit-input{
  color: inherit;
}

.exec-set-row .set-edit-button:hover,
.exec-set-row .set-edit-button:focus{
  color: inherit;
}

.exec-set-planned{
  color: var(--panelBord);
}

.exec-set-planned .set-edit-button{
  border-color: var(--panelBord);
  color: var(--panelBord);
}
.exec-set-planned .set-edit-input{
  border-color: var(--panelBord);
  color: var(--panelBord);
}

.exec-set-planned .routine-set-order{
  color: var(--panelBord);
}

.exec-set-planned .rpe-chip{
  background: transparent;
  border: 1px solid var(--panelBord);
  color: var(--panelBord);
}

.rpe-chip-muted{
  background: transparent;
  border: 1px solid currentColor;
  color: inherit;
}

.rpe-chip.rpe-chip-muted[data-rpe]{
  background: transparent;
  border-color: currentColor;
  box-shadow: none;
}

.set-edit-button:hover,
.set-edit-button:focus{
  outline:none;
}

.set-editor-highlight{
  border-radius: var(--radius);
  outline: 2px solid var(--emphase);
  outline-offset: 0;
}

.inline-set-editor-row{
  margin-top: 4px;
}

.inline-set-editor-button{
  width: 100%;
  min-height: var(--control-h);
  font-weight: var(--fw-strong);
  border-color: var(--panelBord);
}

.inline-set-editor-plus .inline-set-editor-button{
  background: var(--selectedBack);
  color: var(--black);
}

.inline-set-editor-minus .inline-set-editor-button{
  background: var(--selectedBack);
  color: var(--black);
}

.inline-set-editor-actions{
  margin-top: 4px;
}

.inline-keyboard{
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  padding: 11px 14px calc(11px + env(safe-area-inset-bottom, 0));
  background: rgba(248, 248, 248, 0.98);
  box-shadow: 0 -4px 24px rgba(0, 0, 0, 0.08);
  z-index: 9000;
}

.inline-keyboard-content{
  display: grid;
  grid-template-columns: 3fr 1fr;
  gap: 10px;
}

.inline-keyboard-grid{
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
}

.inline-keyboard-actions{
  display: grid;
  grid-template-rows: repeat(4, 45px);
  gap: 10px;
}

.inline-keyboard-action{
  border: 1px solid var(--panelBord);
  border-radius: 14px;
  background: #fff;
  font-size: 16px;
  font-weight: var(--fw-strong);
  color: var(--black);
  padding: 0 6px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background-color 120ms ease, border-color 120ms ease, filter 80ms ease, transform 80ms ease;
}

.inline-keyboard-action--icon{
  font-size: 20px;
}

.inline-keyboard-action--danger{
  border-color: var(--red);
  color: var(--red);
}

.inline-keyboard-action--emphase{
  background: var(--emphase);
  border-color: var(--emphase);
  color: #fff;
}

.inline-keyboard-action--muted{
  color: var(--black);
}

.inline-keyboard-action--span-2{
  grid-row: span 2;
}

.inline-keyboard-action--span-3{
  grid-row: span 3;
}

.inline-keyboard-key{
  height: 45px;
  border: 1px solid var(--panelBord);
  border-radius: 14px;
  background: #fff;
  font-size: 20px;
  font-weight: var(--fw-strong);
  color: var(--black);
  transition: background-color 120ms ease, border-color 120ms ease, filter 80ms ease, transform 80ms ease;
}

.inline-keyboard-key[data-wide="true"]{
  grid-column: span 2;
}

.inline-keyboard-key:active{
  filter: brightness(0.97);
  transform: translateY(1px);
}

.inline-keyboard-key[data-rpe]:active{
  filter: brightness(0.94);
}

.exec-rest-cell{
  font-variant-numeric: tabular-nums;
}

.span-two{
  grid-column: span 2;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
}

.add-actions{
  margin-top: var(--gap);
}

.set-editor-form{
  display:flex;
  flex-direction:column;
  gap:14px;
  min-width:280px;
}

.set-editor-field{
  display:flex;
  flex-direction:column;
  gap:2px;
}


.set-editor-rest{
  grid-column: span 2;
  display:flex;
  flex-direction:column;
  align-items:center;
}

.set-editor-order{
  align-items:center;
  display:flex;
  flex-direction:column;
  gap:6px;
  justify-content:center;
}

.set-editor-order-label{
  margin-bottom: -2px;
}

.set-editor-order-number{
  font-weight: var(--fw-strong);
  font-size: 1.2em;
}

.set-editor-move{
  width: 100%;
}

.set-editor-rest-grid{
  display:grid;
  gap:8px;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  justify-items:center;
  width:100%;
}

.set-editor-subfield{
  display:flex;
  flex-direction:column;
  align-items:center;
}

.set-editor-rest-grid .vstepper{
  width:75%;
}

.set-editor-rest-grid .vstepper .input{
  height: var(--control-h);
  min-height: var(--control-h);
  text-align:center;
}

.set-editor-actions{
  display:flex;
  gap:8px;
}
.set-editor-actions-vertical{
  flex-direction:column;
}
.set-editor-actions-secondary{
  margin-top: -4px;
}

.set-editor-form.set-editor-tone-black .set-editor-field .vstepper .input{
  color: var(--black);
  border-color: var(--black);
}

.set-editor-form.set-editor-tone-black .set-editor-field .vstepper .input{
  font-weight: var(--fw-strong);
}

.set-editor-form.set-editor-tone-muted .set-editor-field .vstepper .input{
  color: var(--selectedBord);
  border-color: var(--selectedBord);
}

.set-editor-form.set-editor-tone-muted .set-editor-field .vstepper .input{
  font-weight: var(--fw-base);
}

.set-editor-form .vstepper{
  width:100%;
}

.set-editor-form .vstepper .input{
  text-align:center;
}



.exec-row.is-selected{
  background: var(--selectedBack);
  color: var(--selectedColor);
  box-shadow: 0 0 0 2px var(--emphase);
  border-radius: var(--radius);
}

.exec-row.is-selected .details,
.exec-row.is-selected .details *,
.exec-row.is-selected .input,
.exec-row.is-selected select{
  color: var(--selectedColor);
}

.exec-row.is-selected .input,
.exec-row.is-selected select{
  background: transparent;
  border-color: var(--selectedBord);
}



/* number sans flèches natives */
input[type="number"]::-webkit-outer-spin-button,
input[type="number"]::-webkit-inner-spin-button{ -webkit-appearance:none; margin:0; }
input[type="number"]{ -moz-appearance:textfield; }


/* =========================================================
   Statistiques
   ========================================================= */
.stats-header {
    margin-bottom: 16px;
}

.stats-subtitle {
    color: var(--selectedBord);
    text-align: center;
}

.stats-chart-card {
    margin-bottom: 16px;
    padding: 0;
    border: 1px solid var(--panelBord);
    border-radius: var(--radius);
}

#statsMetricTags,
#statsRangeTags {
    --tag-columns: 4;
}

.stats-tags-group {
    gap: 6px;
}

.stats-chart {
    width: 100%;
    min-height: 240px;
}

.stats-chart-svg {
    width: 100%;
    height: 240px;
    display: block;
}

.stats-chart-svg .stats-axis-tick {
    font-size: 12px;
    fill: var(--labelColor);
}

.stats-chart-svg .stats-grid-line {
    stroke: var(--labelColor);
    stroke-width: 1;
}

.stats-chart-svg .stats-axis-tick-line {
    stroke: var(--labelColor);
    stroke-width: 1.5;
}

.stats-chart-svg .stats-axis-line {
    stroke: var(--labelColor);
    stroke-width: 2;
}

.stats-chart-line {
    stroke: var(--black);
    stroke-width: 3;
    stroke-linecap: round;
    stroke-linejoin: round;
}

.stats-chart-focus {
    pointer-events: none;
}

.stats-chart-focus-line {
    stroke: var(--emphase);
    stroke-width: 2;
}

.stats-chart-focus[data-visible="false"] {
    opacity: 0;
}

.stats-chart-point {
    cursor: pointer;
    fill: var(--white);
    stroke: var(--black);
    stroke-width: 2;
}

.stats-chart-point.is-active {
    fill: var(--emphase);
    stroke: var(--emphase);
}

.stats-goal-line {
    stroke-width: 2;
    stroke-dasharray: 6 4;
}

.stats-goal-zone {
    opacity: 0.6;
}

.stats-goal-zone-min {
    fill: var(--rpe-5-bg);
}

.stats-goal-zone-max {
    fill: var(--rpe-9-bg);
}

.stats-goal-line-min {
    stroke: var(--rpe-5-bord);
}

.stats-goal-line-max {
    stroke: var(--rpe-10-bord);
}

.stats-goal-trend {
    stroke-width: 2.5;
    stroke-dasharray: 8 6;
    fill: none;
}

.stats-goal-trend-min {
    stroke: var(--rpe-5-bord);
}

.stats-goal-trend-max {
    stroke: var(--rpe-10-bord);
}

.stats-goal-range {
    gap: 8px;
}

.stats-goal-date-row {
    align-items: center;
}

.stats-goal-date {
    flex: 1;
}

.stats-chart-empty {
    padding: 24px 0;
    text-align: center;
    color: var(--selectedBord);
}

.stats-section-title {
    margin: 24px 0 12px;
    font-weight: var(--fw-strong);
}

.stats-timeline {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.stats-timeline-item {
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    align-items: baseline;
    gap: 12px;
    padding: 12px 16px;
    border: 1px solid var(--panelBord);
    border-radius: var(--radius);
    cursor: pointer;
}

.stats-timeline-item:focus-visible {
    outline: 2px solid var(--focusedBord);
    outline-offset: 2px;
}

.stats-timeline-date {
    font-weight: var(--fw-strong);
}

.stats-timeline-middle {
    color: var(--selectedBord);
    font-weight: var(--fw-strong);
    white-space: nowrap;
    text-align: center;
}

.stats-timeline-value {
    color: var(--black);
    font-weight: var(--fw-strong);
    white-space: nowrap;
    text-align: center;
}

.stats-timeline-empty {
    padding: 16px;
    text-align: center;
    color: var(--selectedBord);
    background: transparent;
}

.volume-range {
    margin-bottom: 12px;
}

#volumeRangeTags .tag,
#volumeMuscleRangeTags .tag {
    flex: 0 0 calc((100% - (3 * var(--tag-gap, 1px))) / 4);
    max-width: calc((100% - (3 * var(--tag-gap, 1px))) / 4);
}

#volumeRangeTags .tag:nth-child(1),
#volumeRangeTags .tag:nth-child(2),
#volumeMuscleRangeTags .tag:nth-child(1),
#volumeMuscleRangeTags .tag:nth-child(2) {
    flex-basis: calc((100% - var(--tag-gap, 1px)) / 2);
    max-width: calc((100% - var(--tag-gap, 1px)) / 2);
}

.volume-table {
    width: 100%;
    border-collapse: collapse;
}

.volume-table th,
.volume-table td {
    padding: 8px;
    text-align: left;
    vertical-align: middle;
}

.volume-table th:nth-child(2),
.volume-table th:nth-child(3),
.volume-table td:nth-child(2),
.volume-table td:nth-child(3) {
    text-align: center;
}

.volume-table th {
    color: var(--labelColor);
    font-size: var(--fs-small);
}

.volume-table tbody tr + tr td {
    border-top: 1px solid var(--panelBord);
}

.volume-section-row td {
    padding-top: 16px;
    padding-bottom: 4px;
    font-size: var(--fs-small);
    font-weight: var(--fw-strong);
    color: var(--labelColor);
    border-top: none;
}

.volume-section-empty td {
    padding-top: 4px;
    padding-bottom: 8px;
    color: var(--labelColor);
    border-top: none;
}

.volume-muscle-row td {
    font-weight: var(--fw-strong);
}

.volume-row-clickable {
    cursor: pointer;
}

.volume-row-clickable:hover td,
.volume-row-clickable:focus-within td {
    color: var(--emphase);
}

.mapping-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.mapping-card__actions {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-top: 6px;
}

.mapping-card__actions .btn {
    min-height: 32px;
}

.volume-gauge {
    position: relative;
    height: 28px;
    border-radius: 999px;
    background: var(--clickableBack);
    overflow: hidden;
    min-width: 120px;
}

.volume-gauge-fill {
    position: absolute;
    inset: 0;
    width: 0;
    background: var(--emphase);
    opacity: 0.35;
}

.volume-gauge-label {
    position: relative;
    z-index: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
    font-size: var(--fs-small);
    font-weight: var(--fw-base);
}

.volume-empty {
    padding: 16px;
    text-align: center;
    color: var(--labelColor);
}

.volume-edit-header {
    display: grid;
    grid-template-columns: minmax(0, 1fr) 110px 110px;
    gap: 8px;
    color: var(--labelColor);
    font-size: var(--fs-small);
    margin-bottom: 8px;
}

.volume-edit-list {
    display: grid;
    gap: 8px;
    max-height: 60vh;
    overflow-y: auto;
}

.volume-edit-row {
    display: grid;
    grid-template-columns: minmax(0, 1fr) 110px 110px;
    gap: 8px;
    align-items: center;
}

.volume-edit-label {
    display: flex;
    align-items: center;
    gap: 8px;
}

.volume-edit-input {
    width: 100%;
}



/* Champs spécifiques */
/* =========================================================
   10) Responsivité
   ========================================================= */
@media (min-width: 720px){
  .content{ padding-left:16px; padding-right:16px; }
}
